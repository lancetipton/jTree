((typeof self !== 'undefined' ? self : this)["webpackJsonp_name_"] = (typeof self !== 'undefined' ? self : this)["webpackJsonp_name_"] || []).push([["render-js-store"],{

/***/ "./src/scripts/modules/renders/js/actions.js":
/*!***************************************************!*\
  !*** ./src/scripts/modules/renders/js/actions.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var actions = ['ADD_DATA', 'UPDATE_ITEM', 'UPDATE_SELECTED', 'UPDATE_EXPANDED', 'UPDATE_EDIT'].reduce(function (actions, action) {
  return (actions[action.toUpperCase()] = action.toUpperCase()) && actions;
}, {});
/* harmony default export */ __webpack_exports__["default"] = (actions);

/***/ }),

/***/ "./src/scripts/modules/renders/js/dispatcher.js":
/*!******************************************************!*\
  !*** ./src/scripts/modules/renders/js/dispatcher.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, exports) {

throw new Error("Module build failed (from ./node_modules/babel-loader/lib/index.js):\nError: ENOENT: no such file or directory, open '/Users/lancetipton/tdt/jTree/src/scripts/modules/renders/js/dispatcher.js'");

/***/ }),

/***/ "./src/scripts/modules/renders/js/store.js":
/*!*************************************************!*\
  !*** ./src/scripts/modules/renders/js/store.js ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _dispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dispatcher */ "./src/scripts/modules/renders/js/dispatcher.js");
/* harmony import */ var _actions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./actions */ "./src/scripts/modules/renders/js/actions.js");
function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }



var dispatch = _dispatcher__WEBPACK_IMPORTED_MODULE_0__["default"].dispatch,
    watch = _dispatcher__WEBPACK_IMPORTED_MODULE_0__["default"].watch,
    forget = _dispatcher__WEBPACK_IMPORTED_MODULE_0__["default"].forget,
    create = _dispatcher__WEBPACK_IMPORTED_MODULE_0__["default"].create; // this is used to define if an item should be re-rendered
// it should contain anything that can be changed by a user

var serialItem = function serialItem(item) {
  return [!!item.visible, !!item.expanded, !!item.selected, !!item.edit].join("");
};

var initialState = {
  data: [],
  selected: null,
  childrenCache: {},
  itemCache: {},
  isModalVisible: false
};

var getItem = function getItem(idOrItem, state) {
  return typeof idOrItem === "string" ? state.itemCache[idOrItem] : idOrItem;
};

var getParent = function getParent(item, state) {
  if (item.parentItem) return item.parentItem;
  if (!item.parentId) return null;
  item.parentItem = getItem(item.parentId, state);
  return item.parentItem;
};

var getChildrenOf = function getChildrenOf(id, state) {
  if (id in state.childrenCache) return state.childrenCache[id];
  children = state.data.filter(function (item) {
    return item.parentId === id;
  });
  return children && children.length ? children : false;
};

var updateItemCache = function updateItemCache(itemCache, item) {
  return _objectSpread({}, itemCache, _defineProperty({}, item.id, _objectSpread({}, itemCache[item.id], item)));
};

var onDispatch = function onDispatch(state) {
  for (var _len = arguments.length, action = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    action[_key - 1] = arguments[_key];
  }

  var type = action.type,
      payload = _objectWithoutProperties(action, ["type"]);

  if (!type || !Object.keys(payload).length) return state;

  switch (type) {
    case _actions__WEBPACK_IMPORTED_MODULE_1__["default"].ADD_DATA:
      {
        // newData === Array
        return !payload.newData ? state : _objectSpread({}, state, {
          data: updated.data.concat(payload.newData),
          itemCache: payload.newData.reduce(function (itemCache, item) {
            return (itemCache[item.id] = item) && itemCache;
          }, updated.itemCache)
        });
      }

    case _actions__WEBPACK_IMPORTED_MODULE_1__["default"].UPDATE_ITEM:
      {
        if (!payload || !payload.id) return state;
        var item = getItem(payload.id, state); // If no update, or the item has not been update, just return

        return !item || serialItem(item) === serialItem(payload) ? state : _objectSpread({}, state, {
          itemCache: updateItemCache(state.itemCache, payload)
        });
      }

    case _actions__WEBPACK_IMPORTED_MODULE_1__["default"].UPDATE_SELECTED:
      {
        var _updated = _objectSpread({}, state, {
          selected: null // Remove current selected

        });

        if (state.selected) {
          var curId = state.selected.id;
          _updated.itemCache = updateItemCache(_updated.itemCache, _objectSpread({}, _updated.itemCache[curId], {
            selected: false
          }));
        } // Get the item to update


        var _item = getItem(payload.id, state); // if no item to update reutrn


        if (!_item) return _updated; // Update the passed in item to selected

        _updated.itemCache = updateItemCache(_updated.itemCache, _objectSpread({}, _item, {
          selected: true
        }));
        _updated.selected = _item; // return updated state

        return _updated;
      }

    case _actions__WEBPACK_IMPORTED_MODULE_1__["default"].UPDATE_EXPANDED:
      {
        var _children = getChildrenOf(payload.id, state);

        var _item2 = getItem(payload.id, state);

        return !_item2 ? state : _objectSpread({}, state, {
          itemCache: updateItemCache(updated.itemCache, _objectSpread({}, _item2, {
            expanded: payload.expanded
          })),
          childrenCache: _objectSpread({}, state.childrenCache, _defineProperty({}, _item2.id, _children && _children.map(function (child) {
            return (child.visible = payload.expanded) && child;
          }) || undefined))
        });
      }

    case _actions__WEBPACK_IMPORTED_MODULE_1__["default"].UPDATE_EDIT:
      {
        var _children2 = getChildrenOf(payload.id, state);

        var _item3 = getItem(payload.id, state);

        return !_item3 ? state : _objectSpread({}, state, {
          itemCache: updateItemCache(updated.itemCache, _objectSpread({}, _item3, {
            edit: payload.edit
          }))
        });
      }
  }
};

/* harmony default export */ __webpack_exports__["default"] = (function (startState) {
  return create(onDispatch, _objectSpread({}, initialState, startState));
});

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc2NyaXB0cy9tb2R1bGVzL3JlbmRlcnMvanMvYWN0aW9ucy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc2NyaXB0cy9tb2R1bGVzL3JlbmRlcnMvanMvc3RvcmUuanMiXSwibmFtZXMiOlsiYWN0aW9ucyIsInJlZHVjZSIsImFjdGlvbiIsInRvVXBwZXJDYXNlIiwiZGlzcGF0Y2giLCJkaXNwYXRjaGVyIiwid2F0Y2giLCJmb3JnZXQiLCJjcmVhdGUiLCJzZXJpYWxJdGVtIiwiaXRlbSIsInZpc2libGUiLCJleHBhbmRlZCIsInNlbGVjdGVkIiwiZWRpdCIsImpvaW4iLCJpbml0aWFsU3RhdGUiLCJkYXRhIiwiY2hpbGRyZW5DYWNoZSIsIml0ZW1DYWNoZSIsImlzTW9kYWxWaXNpYmxlIiwiZ2V0SXRlbSIsImlkT3JJdGVtIiwic3RhdGUiLCJnZXRQYXJlbnQiLCJwYXJlbnRJdGVtIiwicGFyZW50SWQiLCJnZXRDaGlsZHJlbk9mIiwiaWQiLCJjaGlsZHJlbiIsImZpbHRlciIsImxlbmd0aCIsInVwZGF0ZUl0ZW1DYWNoZSIsIm9uRGlzcGF0Y2giLCJ0eXBlIiwicGF5bG9hZCIsIk9iamVjdCIsImtleXMiLCJBRERfREFUQSIsIm5ld0RhdGEiLCJ1cGRhdGVkIiwiY29uY2F0IiwiVVBEQVRFX0lURU0iLCJVUERBVEVfU0VMRUNURUQiLCJjdXJJZCIsIlVQREFURV9FWFBBTkRFRCIsIm1hcCIsImNoaWxkIiwidW5kZWZpbmVkIiwiVVBEQVRFX0VESVQiLCJzdGFydFN0YXRlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFBQSxJQUFNQSxPQUFPLEdBQUcsQ0FDZCxVQURjLEVBRWQsYUFGYyxFQUdkLGlCQUhjLEVBSWQsaUJBSmMsRUFLZCxhQUxjLEVBTWRDLE1BTmMsQ0FNUCxVQUFDRCxPQUFELEVBQVVFLE1BQVY7QUFBQSxTQUNQLENBQUNGLE9BQU8sQ0FBQ0UsTUFBTSxDQUFDQyxXQUFQLEVBQUQs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aUIsR0FBVCxDQUFhLFVBQUFDLEtBQUs7QUFBQSxtQkFDdkMsQ0FBQ0EsS0FBSyxDQUFDcEMsT0FBTixHQUFnQndCLE9BQU8sQ0FBQ3ZCLFFBQXpCLEtBQXNDbUMsS0FEQztBQUFBLFdBQWxCLENBQVosSUFFTEMsU0FKSztBQVJWLFVBQVA7QUFlRDs7QUFFRCxTQUFLaEQsZ0RBQU8sQ0FBQ2lELFdBQWI7QUFBMEI7QUFDeEIsWUFBTXBCLFVBQVEsR0FBR0YsYUFBYSxDQUFDUSxPQUFPLENBQUNQLEVBQVQsRUFBYUwsS0FBYixDQUE5Qjs7QUFDQSxZQUFNYixNQUFJLEdBQUdXLE9BQU8sQ0FBQ2MsT0FBTyxDQUFDUCxFQUFULEVBQWFMLEtBQWIsQ0FBcEI7O0FBRUEsZUFBTyxDQUFDYixNQUFELEdBQ0hhLEtBREcscUJBR0FBLEtBSEE7QUFJSEosbUJBQVMsRUFBRWEsZUFBZSxDQUFDUSxPQUFPLENBQUNyQixTQUFULG9CQUNyQlQsTUFEcUI7QUFFeEJJLGdCQUFJLEVBQUVxQixPQUFPLENBQUNyQjtBQUZVO0FBSnZCLFVBQVA7QUFTRDtBQXpGSDtBQTRGRCxDQWpHRDs7QUFtR2UseUVBQUFvQyxVQUFVO0FBQUEsU0FBSTFDLE1BQU0sQ0FBQ3lCLFVBQUQsb0JBQWtCakIsWUFBbEIsRUFBbUNrQyxVQUFuQyxFQUFWO0FBQUEsQ0FBekIsRSIsImZpbGUiOiJyZW5kZXItanMtc3RvcmUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYWN0aW9ucyA9IFtcbiAgJ0FERF9EQVRBJyxcbiAgJ1VQREFURV9JVEVNJyxcbiAgJ1VQREFURV9TRUxFQ1RFRCcsXG4gICdVUERBVEVfRVhQQU5ERUQnLFxuICAnVVBEQVRFX0VESVQnXG5dLnJlZHVjZSgoYWN0aW9ucywgYWN0aW9uKSA9PiAoXG4gIChhY3Rpb25zW2FjdGlvbi50b1VwcGVyQ2FzZSgpXSA9IGFjdGlvbi50b1VwcGVyQ2FzZSgpKSAmJiBhY3Rpb25zXG4pLCB7fSlcblxuZXhwb3J0IGRlZmF1bHQgYWN0aW9ucyIsImltcG9ydCBkaXNwYXRjaGVyIGZyb20gJy4vZGlzcGF0Y2hlcidcbmltcG9ydCBhY3Rpb25zIGZyb20gJy4vYWN0aW9ucydcbmNvbnN0IHsgZGlzcGF0Y2gsIHdhdGNoLCBmb3JnZXQsIGNyZWF0ZSB9ID0gZGlzcGF0Y2hlclxuXG4vLyB0aGlzIGlzIHVzZWQgdG8gZGVmaW5lIGlmIGFuIGl0ZW0gc2hvdWxkIGJlIHJlLXJlbmRlcmVkXG4vLyBpdCBzaG91bGQgY29udGFpbiBhbnl0aGluZyB0aGF0IGNhbiBiZSBjaGFuZ2VkIGJ5IGEgdXNlclxuY29uc3Qgc2VyaWFsSXRlbSA9IGl0ZW0gPT4gW1xuICAhIWl0ZW0udmlzaWJsZSxcbiAgISFpdGVtLmV4cGFuZGVkLFxuICAhIWl0ZW0uc2VsZWN0ZWQsXG4gICEhaXRlbS5lZGl0LFxuXS5qb2luKGBgKVxuXG5jb25zdCBpbml0aWFsU3RhdGUgPSB7XG4gIGRhdGE6IFtdLFxuICBzZWxlY3RlZDogbnVsbCxcbiAgY2hpbGRyZW5DYWNoZToge30sXG4gIGl0ZW1DYWNoZToge30sXG4gIGlzTW9kYWxWaXNpYmxlOiBmYWxzZSxcbn1cblxuY29uc3QgZ2V0SXRlbSA9IChpZE9ySXRlbSwgc3RhdGUpID0+IChcbiAgdHlwZW9mIGlkT3JJdGVtID09PSBgc3RyaW5nYFxuICAgID8gc3RhdGUuaXRlbUNhY2hlW2lkT3JJdGVtXVxuICAgIDogaWRPckl0ZW1cbilcbmNvbnN0IGdldFBhcmVudCA9IChpdGVtLCBzdGF0ZSkgPT4ge1xuICBpZiAoaXRlbS5wYXJlbnRJdGVtKSByZXR1cm4gaXRlbS5wYXJlbnRJdGVtXG4gIGlmICghaXRlbS5wYXJlbnRJZCkgcmV0dXJuIG51bGxcblxuICBpdGVtLnBhcmVudEl0ZW0gPSBnZXRJdGVtKGl0ZW0ucGFyZW50SWQsIHN0YXRlKVxuICByZXR1cm4gaXRlbS5wYXJlbnRJdGVtXG59XG5jb25zdCBnZXRDaGlsZHJlbk9mID0gKGlkLCBzdGF0ZSkgPT4ge1xuICBpZiAoaWQgaW4gc3RhdGUuY2hpbGRyZW5DYWNoZSlcbiAgICByZXR1cm4gc3RhdGUuY2hpbGRyZW5DYWNoZVtpZF1cblxuICBjaGlsZHJlbiA9IHN0YXRlLmRhdGEuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wYXJlbnRJZCA9PT0gaWQpXG5cbiAgcmV0dXJuIGNoaWxkcmVuICYmIGNoaWxkcmVuLmxlbmd0aFxuICAgID8gY2hpbGRyZW5cbiAgICA6IGZhbHNlXG59XG5cbmNvbnN0IHVwZGF0ZUl0ZW1DYWNoZSA9IChpdGVtQ2FjaGUsIGl0ZW0pID0+ICh7XG4gIC4uLml0ZW1DYWNoZSxcbiAgW2l0ZW0uaWRdOiB7XG4gICAgLi4uaXRlbUNhY2hlW2l0ZW0uaWRdLFxuICAgIC4uLml0ZW1cbiAgfVxufSlcblxuY29uc3Qgb25EaXNwYXRjaCA9IChzdGF0ZSwgLi4uYWN0aW9uKSA9PiB7XG4gIGNvbnN0IHsgdHlwZSwgLi4ucGF5bG9hZCB9ID0gYWN0aW9uXG4gIGlmKCF0eXBlIHx8ICFPYmplY3Qua2V5cyhwYXlsb2FkKS5sZW5ndGgpXG4gICAgcmV0dXJuIHN0YXRlXG4gIFxuICBzd2l0Y2godHlwZSl7XG5cbiAgICBjYXNlIGFjdGlvbnMuQUREX0RBVEE6IHtcbiAgICAgIC8vIG5ld0RhdGEgPT09IEFycmF5XG4gICAgICByZXR1cm4gIXBheWxvYWQubmV3RGF0YVxuICAgICAgICA/IHN0YXRlXG4gICAgICAgIDoge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICBkYXRhOiB1cGRhdGVkLmRhdGEuY29uY2F0KHBheWxvYWQubmV3RGF0YSksXG4gICAgICAgICAgICBpdGVtQ2FjaGU6IHBheWxvYWQubmV3RGF0YS5yZWR1Y2UoKGl0ZW1DYWNoZSwgaXRlbSkgPT4gKFxuICAgICAgICAgICAgICAoaXRlbUNhY2hlW2l0ZW0uaWRdID0gaXRlbSkgJiYgaXRlbUNhY2hlKSxcbiAgICAgICAgICAgICAgdXBkYXRlZC5pdGVtQ2FjaGVcbiAgICAgICAgICAgIClcbiAgICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNhc2UgYWN0aW9ucy5VUERBVEVfSVRFTToge1xuICAgICAgaWYoIXBheWxvYWQgfHwgIXBheWxvYWQuaWQpXG4gICAgICAgIHJldHVybiBzdGF0ZVxuXG4gICAgICBjb25zdCBpdGVtID0gZ2V0SXRlbShwYXlsb2FkLmlkLCBzdGF0ZSlcbiAgICAgIC8vIElmIG5vIHVwZGF0ZSwgb3IgdGhlIGl0ZW0gaGFzIG5vdCBiZWVuIHVwZGF0ZSwganVzdCByZXR1cm5cbiAgICAgIHJldHVybiAhaXRlbSB8fCBzZXJpYWxJdGVtKGl0ZW0pID09PSBzZXJpYWxJdGVtKHBheWxvYWQpXG4gICAgICAgID8gc3RhdGVcbiAgICAgICAgOiB7XG4gICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgaXRlbUNhY2hlOiB1cGRhdGVJdGVtQ2FjaGUoc3RhdGUuaXRlbUNhY2hlLCBwYXlsb2FkKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FzZSBhY3Rpb25zLlVQREFURV9TRUxFQ1RFRDoge1xuICAgICAgY29uc3QgdXBkYXRlZCA9IHsgLi4uc3RhdGUsIHNlbGVjdGVkOiBudWxsIH1cbiAgICAgIC8vIFJlbW92ZSBjdXJyZW50IHNlbGVjdGVkXG4gICAgICBpZihzdGF0ZS5zZWxlY3RlZCl7XG4gICAgICAgIGNvbnN0IGN1cklkID0gc3RhdGUuc2VsZWN0ZWQuaWRcbiAgICAgICAgdXBkYXRlZC5pdGVtQ2FjaGUgPSB1cGRhdGVJdGVtQ2FjaGUodXBkYXRlZC5pdGVtQ2FjaGUsIHtcbiAgICAgICAgICAuLi51cGRhdGVkLml0ZW1DYWNoZVtjdXJJZF0sXG4gICAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgLy8gR2V0IHRoZSBpdGVtIHRvIHVwZGF0ZVxuICAgICAgY29uc3QgaXRlbSA9IGdldEl0ZW0ocGF5bG9hZC5pZCwgc3RhdGUpXG4gICAgICAvLyBpZiBubyBpdGVtIHRvIHVwZGF0ZSByZXV0cm5cbiAgICAgIGlmKCFpdGVtKSByZXR1cm4gdXBkYXRlZFxuICAgICAgLy8gVXBkYXRlIHRoZSBwYXNzZWQgaW4gaXRlbSB0byBzZWxlY3RlZFxuICAgICAgdXBkYXRlZC5pdGVtQ2FjaGUgPSB1cGRhdGVJdGVtQ2FjaGUodXBkYXRlZC5pdGVtQ2FjaGUsIHtcbiAgICAgICAgLi4uaXRlbSxcbiAgICAgICAgc2VsZWN0ZWQ6IHRydWUsXG4gICAgICB9KVxuICAgICAgdXBkYXRlZC5zZWxlY3RlZCA9IGl0ZW1cblxuICAgICAgLy8gcmV0dXJuIHVwZGF0ZWQgc3RhdGVcbiAgICAgIHJldHVybiB1cGRhdGVkXG4gICAgfVxuICAgIFxuICAgIGNhc2UgYWN0aW9ucy5VUERBVEVfRVhQQU5ERUQ6IHtcbiAgICAgIGNvbnN0IGNoaWxkcmVuID0gZ2V0Q2hpbGRyZW5PZihwYXlsb2FkLmlkLCBzdGF0ZSlcbiAgICAgIGNvbnN0IGl0ZW0gPSBnZXRJdGVtKHBheWxvYWQuaWQsIHN0YXRlKVxuICAgICAgXG4gICAgICByZXR1cm4gIWl0ZW1cbiAgICAgICAgPyBzdGF0ZVxuICAgICAgICA6IHtcbiAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICBpdGVtQ2FjaGU6IHVwZGF0ZUl0ZW1DYWNoZSh1cGRhdGVkLml0ZW1DYWNoZSwge1xuICAgICAgICAgICAgLi4uaXRlbSxcbiAgICAgICAgICAgIGV4cGFuZGVkOiBwYXlsb2FkLmV4cGFuZGVkLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIGNoaWxkcmVuQ2FjaGU6IHtcbiAgICAgICAgICAgIC4uLnN0YXRlLmNoaWxkcmVuQ2FjaGUsXG4gICAgICAgICAgICBbaXRlbS5pZF06IGNoaWxkcmVuICYmIGNoaWxkcmVuLm1hcChjaGlsZCA9PiAoXG4gICAgICAgICAgICAgIChjaGlsZC52aXNpYmxlID0gcGF5bG9hZC5leHBhbmRlZCkgJiYgY2hpbGRcbiAgICAgICAgICAgICkpIHx8IHVuZGVmaW5lZFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNhc2UgYWN0aW9ucy5VUERBVEVfRURJVDoge1xuICAgICAgY29uc3QgY2hpbGRyZW4gPSBnZXRDaGlsZHJlbk9mKHBheWxvYWQuaWQsIHN0YXRlKVxuICAgICAgY29uc3QgaXRlbSA9IGdldEl0ZW0ocGF5bG9hZC5pZCwgc3RhdGUpXG4gICAgICBcbiAgICAgIHJldHVybiAhaXRlbVxuICAgICAgICA/IHN0YXRlXG4gICAgICAgIDoge1xuICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgIGl0ZW1DYWNoZTogdXBkYXRlSXRlbUNhY2hlKHVwZGF0ZWQuaXRlbUNhY2hlLCB7XG4gICAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgICAgZWRpdDogcGF5bG9hZC5lZGl0LFxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBzdGFydFN0YXRlID0+IGNyZWF0ZShvbkRpc3BhdGNoLCB7IC4uLmluaXRpYWxTdGF0ZSwgLi4uc3RhcnRTdGF0ZSB9KVxuXG5cbiJdLCJzb3VyY2VSb290IjoiIn0=